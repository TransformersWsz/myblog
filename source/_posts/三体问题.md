---
title: ä¸‰ä½“é—®é¢˜
mathjax: true
toc: true
date: 2025-06-09 02:46:06
updated: 2025-06-09 02:46:06
categories:
- éšç¬”
tags:
- Three-Body
---
ä»ç‰©ç†å­¦è§’åº¦ï¼Œä¸‰ä½“é—®é¢˜ä¹‹æ‰€ä»¥ä¸ç¨³å®šï¼Œæ˜¯å› ä¸ºä¸‰ä¸ªå¤©ä½“åœ¨ä¸‡æœ‰å¼•åŠ›ä½œç”¨ä¸‹ç›¸äº’ä½œç”¨ï¼Œå½¢æˆä¸€ä¸ªéçº¿æ€§è€¦åˆç³»ç»Ÿã€‚æˆ‘ä»¬å¯ä»¥ä»ç‰›é¡¿ç»å…¸åŠ›å­¦å‡ºå‘ï¼Œåˆ—å‡ºå…·ä½“çš„è¿åŠ¨æ–¹ç¨‹ï¼Œå¹¶è¯´æ˜ä¸ºä½•è¿™ä¸ªç³»ç»Ÿæœ¬è´¨ä¸Šæ˜¯æ··æ²Œçš„ï¼Œæ— æ³•å¾—åˆ°ä¸€èˆ¬è§£æè§£ã€‚

<!--more-->

## ğŸ§­ é—®é¢˜è®¾å®šï¼šä¸‰ä½“ç³»ç»Ÿçš„åŸºæœ¬å‡è®¾

å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªè´¨é‡åˆ†åˆ«ä¸º $m_1, m_2, m_3$ çš„å¤©ä½“ï¼Œä½ç½®å‘é‡åˆ†åˆ«ä¸ºï¼š

* $\mathbf{r}_1(t)$
* $\mathbf{r}_2(t)$
* $\mathbf{r}_3(t)$

åœ¨ç‰›é¡¿å¼•åŠ›å®šå¾‹ä¸‹ï¼Œæ¯ä¸ªå¤©ä½“å—åˆ°å…¶ä½™ä¸¤ä¸ªå¤©ä½“çš„å¼•åŠ›ï¼Œæ€»åŠ é€Ÿåº¦ç”±ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼ˆ$\mathbf{F} = m\mathbf{a}$ï¼‰ç»™å‡ºã€‚

---

## ğŸ“ ä¸€èˆ¬å½¢å¼çš„è¿åŠ¨æ–¹ç¨‹ï¼ˆç‰›é¡¿å¼•åŠ› + ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼‰

å¯¹ç¬¬ä¸€ä¸ªå¤©ä½“ $m_1$ï¼Œå…¶åŠ é€Ÿåº¦ä¸ºï¼š

$$
m_1 \frac{d^2 \mathbf{r}_1}{dt^2} = G \frac{m_1 m_2}{|\mathbf{r}_2 - \mathbf{r}_1|^3} (\mathbf{r}_2 - \mathbf{r}_1) + G \frac{m_1 m_3}{|\mathbf{r}_3 - \mathbf{r}_1|^3} (\mathbf{r}_3 - \mathbf{r}_1)
$$

ç±»ä¼¼åœ°ï¼Œå¯¹ $m_2, m_3$ åˆ†åˆ«æœ‰ï¼š

$$
m_2 \frac{d^2 \mathbf{r}_2}{dt^2} = G \frac{m_2 m_1}{|\mathbf{r}_1 - \mathbf{r}_2|^3} (\mathbf{r}_1 - \mathbf{r}_2) + G \frac{m_2 m_3}{|\mathbf{r}_3 - \mathbf{r}_2|^3} (\mathbf{r}_3 - \mathbf{r}_2)
$$

$$
m_3 \frac{d^2 \mathbf{r}_3}{dt^2} = G \frac{m_3 m_1}{|\mathbf{r}_1 - \mathbf{r}_3|^3} (\mathbf{r}_1 - \mathbf{r}_3) + G \frac{m_3 m_2}{|\mathbf{r}_2 - \mathbf{r}_3|^3} (\mathbf{r}_2 - \mathbf{r}_3)
$$

---

## âš ï¸ ä¸ºä»€ä¹ˆä¸ç¨³å®šï¼Ÿ

### 1. éçº¿æ€§è€¦åˆå¾®åˆ†æ–¹ç¨‹ç»„

è¿™ä¸‰ç»„å¼å­å½¼æ­¤é«˜åº¦è€¦åˆï¼šæ¯ä¸ªåŠ é€Ÿåº¦éƒ½ä¾èµ–äºå¦å¤–ä¸¤ä¸ªå¤©ä½“çš„ä½ç½®ï¼Œè€Œä¸”è¿™ç§ä¾èµ–æ˜¯éçº¿æ€§ï¼ˆè·ç¦»çš„ä¸‰æ¬¡æ–¹åœ¨åˆ†æ¯ï¼‰ã€‚

è¿™æ˜¯å…¸å‹çš„éçº¿æ€§äºŒé˜¶å¸¸å¾®åˆ†æ–¹ç¨‹ç»„ï¼Œå½¢å¼ä¸Šå¦‚ä¸‹ï¼š

$$
\frac{d^2 \mathbf{r}_i}{dt^2} = \sum_{j \ne i} G m_j \frac{\mathbf{r}_j - \mathbf{r}_i}{|\mathbf{r}_j - \mathbf{r}_i|^3}, \quad i = 1,2,3
$$

è¿™ç§ç³»ç»Ÿå­˜åœ¨å¦‚ä¸‹ä¸‰å¤§ç‰¹æ€§ï¼š
- ä¸å¯åˆ†è§£æˆå•ä½“è¿åŠ¨ + å¾®æ‰°é¡¹
- æ— æ³•é€šè¿‡ä»£æ•°æ–¹æ³•æ±‚å‡ºé€šè§£
- éšæ—¶é—´æ¼”åŒ–ä¼šå±•ç°å‡ºå¯¹åˆå§‹æ¡ä»¶çš„æåº¦æ•æ„Ÿ

---

### 2. åˆå§‹æ¡ä»¶æ•æ„Ÿæ€§ï¼ˆæ··æ²Œç‰¹å¾ï¼‰

åœ¨æ•°å€¼æ¨¡æ‹Ÿä¸­ï¼Œå³ä½¿ä¸¤ä¸ªä¸‰ä½“ç³»ç»Ÿåˆå§‹ä½ç½®å·®å¼‚ä¸º $10^{-10}$ ç±³ï¼Œå‡ åä¸ªå‘¨æœŸåè½¨é“ä¼šå®Œå…¨ä¸åŒã€‚

è¿™æ˜¯æ··æ²Œç³»ç»Ÿçš„å®šä¹‰ç‰¹å¾ï¼š

> åˆå§‹æ¡ä»¶å¾®å°æ‰°åŠ¨ä¼šè¢«æ”¾å¤§ï¼Œå¯¼è‡´é•¿æœŸè¡Œä¸ºå®Œå…¨ä¸å¯é¢„æµ‹ã€‚

---

### 3. å®ˆæ’å®šå¾‹çº¦æŸä¸è¶³ä»¥ç¨³å®šç³»ç»Ÿ

è™½ç„¶ç³»ç»Ÿæ»¡è¶³ä»¥ä¸‹å®ˆæ’å®šå¾‹ï¼š

- æ€»åŠ¨é‡å®ˆæ’ï¼š

  $$
  \sum_{i=1}^3 m_i \frac{d \mathbf{r}_i}{dt} = \text{å¸¸é‡}
  $$
- æ€»èƒ½é‡å®ˆæ’ï¼š

  $$
  E = \sum_{i=1}^3 \frac{1}{2} m_i v_i^2 - \sum_{i<j} \frac{G m_i m_j}{|\mathbf{r}_i - \mathbf{r}_j|}
  $$

ä½†è¿™äº›å®ˆæ’é‡ï¼ˆå¸¸æ•°ï¼‰æ— æ³•é™åˆ¶è½¨é“åœ¨é«˜ç»´ç©ºé—´çš„å‘æ•£æ¼”åŒ–ï¼Œåªæ˜¯æä¾›ä¸€äº›â€œæ•´ä½“çº¦æŸâ€ã€‚

## ğŸ“‰ æ‰€ä»¥ä¸ºä»€ä¹ˆä¸èƒ½ç¨³å®šè¿è¡Œï¼Ÿ

ä»ç‰©ç†è§’åº¦æ€»ç»“ä¸‰ç‚¹ï¼š

1. å¤šä½“å¼•åŠ›æ˜¯éçº¿æ€§ä¸”æ—¶å˜çš„åŠ›å­¦ç³»ç»Ÿï¼›
2. æ— è§£æè§£ï¼ˆé™¤æå°‘å¯¹ç§°æƒ…å†µï¼‰ï¼Œå¿…é¡»æ•°å€¼æ±‚è§£ï¼›
3. å³ä½¿æ•°å€¼è§£ï¼Œä¹Ÿæåº¦ä¾èµ–åˆå§‹æ¡ä»¶ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºæ··æ²Œè½¨é“ï¼›


### ğŸ¯ å®é™…ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ

å°è¯´ä¸­ä¸‰ä½“è¡Œæ˜Ÿæ–‡æ˜é¢ä¸´çš„æ ¸å¿ƒå›°å¢ƒâ€”â€”æ— æ³•é¢„æµ‹ä¸‰é¢—æ’æ˜Ÿçš„è¿åŠ¨ã€‚æ­£æ˜¯è¿™ä¸ªçœŸå®çš„ç‰©ç†é—®é¢˜ï¼Œä½¿å¾—ä¸‰ä½“æ–‡æ˜çš„â€œä¹±çºªå…ƒâ€å’Œâ€œæ’çºªå…ƒâ€äº¤æ›¿æˆä¸ºå¿…ç„¶ï¼Œä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆä»–ä»¬éœ€è¦å¯»æ‰¾æ–°çš„å®¶å›­ã€‚æ•°å€¼æ¨¡æ‹Ÿè¯å®äº†è¿™ç§ä¸ç¨³å®šæ€§æ˜¯ä¸‰ä½“ç³»ç»Ÿçš„å†…åœ¨å±æ€§ï¼Œè€Œéå¤–éƒ¨å¹²æ‰°çš„ç»“æœã€‚

## ä¸‰ä½“è¿åŠ¨çš„æ¨¡æ‹ŸåŠ¨ç”»

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
import matplotlib.patches as patches
from matplotlib.widgets import Button
from collections import deque

# è®¾ç½®ä¸­æ–‡å­—ä½“
plt.rcParams['font.sans-serif'] = ['SimHei', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False


class ThreeBodySystem:
    def __init__(self, masses, positions, velocities, G=1.0):
        """
        ä¸‰ä½“ç³»ç»Ÿ
        masses: [m1, m2, m3] ä¸‰ä¸ªå¤©ä½“çš„è´¨é‡
        positions: [[x1,y1], [x2,y2], [x3,y3]] åˆå§‹ä½ç½®
        velocities: [[vx1,vy1], [vx2,vy2], [vx3,vy3]] åˆå§‹é€Ÿåº¦
        G: å¼•åŠ›å¸¸æ•°
        """
        self.masses = np.array(masses)
        self.positions = np.array(positions, dtype=float)
        self.velocities = np.array(velocities, dtype=float)
        self.G = G

        # è½¨è¿¹å†å²è®°å½• - ä¸ºæ¯ä¸ªå¤©ä½“å•ç‹¬è®°å½•
        self.trail_length = 800
        self.trails = [deque(maxlen=self.trail_length) for _ in range(3)]

        # åˆå§‹åŒ–è½¨è¿¹è®°å½•
        for i in range(3):
            self.trails[i].append([self.positions[i][0], self.positions[i][1]])

        self.dt = 0.005  # åŸºç¡€æ—¶é—´æ­¥é•¿
        self.speed_multiplier = 1.0  # é€Ÿåº¦å€æ•°
        self.time = 0

        # å¤©ä½“å±æ€§
        self.colors = ['#FF6B35', '#004E89', '#00A86B']  # æ©™è‰²ã€æ·±è“ã€ç»¿è‰²
        self.names = ['æ’æ˜ŸAlpha', 'æ’æ˜ŸBeta', 'æ’æ˜ŸGamma']
        self.base_sizes = [300, 250, 280]

        # ç»Ÿè®¡æ•°æ®è®°å½•
        self.energy_history = deque(maxlen=500)
        self.distance_history = {'AB': deque(maxlen=500),
                                 'AC': deque(maxlen=500),
                                 'BC': deque(maxlen=500)}

    def set_speed_multiplier(self, multiplier):
        """è®¾ç½®é€Ÿåº¦å€æ•°"""
        self.speed_multiplier = max(0.1, min(10.0, multiplier))

    def compute_gravitational_forces(self):
        """è®¡ç®—æ¯ä¸ªå¤©ä½“å—åˆ°çš„å¼•åŠ›"""
        forces = np.zeros_like(self.positions)

        for i in range(3):
            for j in range(3):
                if i != j:
                    # ä½ç½®å·®çŸ¢é‡: ä»iæŒ‡å‘j
                    r_vec = self.positions[j] - self.positions[i]
                    r_magnitude = np.linalg.norm(r_vec)

                    # é¿å…æ•°å€¼å¥‡ç‚¹
                    if r_magnitude > 1e-8:
                        # ä¸‡æœ‰å¼•åŠ›: F = G*m1*m2/r^2 * å•ä½çŸ¢é‡
                        force_magnitude = self.G * self.masses[i] * self.masses[j] / (r_magnitude ** 3)
                        forces[i] += force_magnitude * r_vec

        return forces

    def runge_kutta_4th_order(self):
        """å››é˜¶é¾™æ ¼-åº“å¡”æ³•æ•°å€¼ç§¯åˆ†ï¼ˆå¸¦é€Ÿåº¦æ§åˆ¶ï¼‰"""
        effective_dt = self.dt * self.speed_multiplier

        # å½“å‰çŠ¶æ€
        pos = self.positions.copy()
        vel = self.velocities.copy()

        # k1 è®¡ç®—
        k1_vel = vel
        k1_acc = self.compute_gravitational_forces() / self.masses.reshape(-1, 1)

        # k2 è®¡ç®—
        pos_k2 = pos + 0.5 * effective_dt * k1_vel
        self.positions = pos_k2  # ä¸´æ—¶æ›´æ–°ä½ç½®ç”¨äºåŠ›è®¡ç®—
        k2_vel = vel + 0.5 * effective_dt * k1_acc
        k2_acc = self.compute_gravitational_forces() / self.masses.reshape(-1, 1)

        # k3 è®¡ç®—
        pos_k3 = pos + 0.5 * effective_dt * k2_vel
        self.positions = pos_k3
        k3_vel = vel + 0.5 * effective_dt * k2_acc
        k3_acc = self.compute_gravitational_forces() / self.masses.reshape(-1, 1)

        # k4 è®¡ç®—
        pos_k4 = pos + effective_dt * k3_vel
        self.positions = pos_k4
        k4_vel = vel + effective_dt * k3_acc
        k4_acc = self.compute_gravitational_forces() / self.masses.reshape(-1, 1)

        # æœ€ç»ˆæ›´æ–°
        self.positions = pos + effective_dt * (k1_vel + 2 * k2_vel + 2 * k3_vel + k4_vel) / 6
        self.velocities = vel + effective_dt * (k1_acc + 2 * k2_acc + 2 * k3_acc + k4_acc) / 6

        # è®°å½•è½¨è¿¹
        for i in range(3):
            self.trails[i].append([self.positions[i][0], self.positions[i][1]])

        self.time += effective_dt

    def calculate_total_energy(self):
        """è®¡ç®—ç³»ç»Ÿæ€»èƒ½é‡ï¼ˆåŠ¨èƒ½+åŠ¿èƒ½ï¼‰"""
        # åŠ¨èƒ½
        kinetic_energy = 0
        for i in range(3):
            v_squared = np.sum(self.velocities[i] ** 2)
            kinetic_energy += 0.5 * self.masses[i] * v_squared

        # å¼•åŠ›åŠ¿èƒ½
        potential_energy = 0
        for i in range(3):
            for j in range(i + 1, 3):
                r = np.linalg.norm(self.positions[i] - self.positions[j])
                if r > 1e-8:
                    potential_energy -= self.G * self.masses[i] * self.masses[j] / r

        return kinetic_energy + potential_energy

    def update_statistics(self):
        """æ›´æ–°ç»Ÿè®¡æ•°æ®"""
        # æ€»èƒ½é‡
        energy = self.calculate_total_energy()
        self.energy_history.append(energy)

        # å¤©ä½“é—´è·ç¦»
        r_AB = np.linalg.norm(self.positions[0] - self.positions[1])
        r_AC = np.linalg.norm(self.positions[0] - self.positions[2])
        r_BC = np.linalg.norm(self.positions[1] - self.positions[2])

        self.distance_history['AB'].append(r_AB)
        self.distance_history['AC'].append(r_AC)
        self.distance_history['BC'].append(r_BC)


class SpeedController:
    """é€Ÿåº¦æ§åˆ¶å™¨ç±»"""

    def __init__(self, system):
        self.system = system
        self.speed_levels = [0.1, 0.25, 0.5, 1.0, 2.0, 4.0, 8.0]
        self.current_level = 3  # é»˜è®¤1.0å€é€Ÿ

    def speed_up(self, event=None):
        """åŠ é€Ÿ"""
        if self.current_level < len(self.speed_levels) - 1:
            self.current_level += 1
            self.current_level = min(self.current_level, len(self.speed_levels)-1)
            self.system.set_speed_multiplier(self.speed_levels[self.current_level])

    def slow_down(self, event=None):
        """å‡é€Ÿ"""
        if self.current_level > 0:
            self.current_level -= 1
            self.current_level = max(self.current_level, 0)
            self.system.set_speed_multiplier(self.speed_levels[self.current_level])

    def reset_speed(self, event=None):
        """é‡ç½®åˆ°æ­£å¸¸é€Ÿåº¦"""
        self.current_level = 3
        self.system.set_speed_multiplier(self.speed_levels[self.current_level])

    def get_current_speed_text(self):
        """è·å–å½“å‰é€Ÿåº¦æ˜¾ç¤ºæ–‡æœ¬"""
        speed = self.speed_levels[self.current_level]
        return f"æ’­æ”¾é€Ÿåº¦: {speed:.1f}x"


def create_three_body_animation():
    """åˆ›å»ºå¸¦é€Ÿåº¦æ§åˆ¶çš„ä¸‰ä½“è¿åŠ¨åŠ¨ç”»"""

    # åˆå§‹åŒ–ç³»ç»Ÿ - é€‰æ‹©ä¸€ä¸ªå±•ç°æ··æ²Œç‰¹æ€§çš„é…ç½®
    masses = [1.5, 1.0, 1.2]  # ä¸‰ä¸ªä¸åŒè´¨é‡çš„æ’æ˜Ÿ

    # ä¸‰è§’å½¢åˆå§‹é…ç½®ï¼Œä½†æœ‰é€‚å½“çš„é€Ÿåº¦äº§ç”Ÿå¤æ‚è½¨é“
    positions = [
        [-2.0, 0.0],  # Alphaæ˜Ÿ
        [1.0, 1.732],  # Betaæ˜Ÿ
        [1.0, -1.732]  # Gammaæ˜Ÿ
    ]

    velocities = [
        [0.2, 0.8],  # Alphaæ˜Ÿåˆå§‹é€Ÿåº¦
        [-0.6, -0.2],  # Betaæ˜Ÿåˆå§‹é€Ÿåº¦
        [0.4, -0.6]  # Gammaæ˜Ÿåˆå§‹é€Ÿåº¦
    ]

    system = ThreeBodySystem(masses, positions, velocities, G=3.0)
    speed_controller = SpeedController(system)

    # åˆ›å»ºå›¾å½¢ç•Œé¢
    fig = plt.figure(figsize=(19, 12), facecolor='#0a0a0a')

    # ä¸»åŠ¨ç”»åŒºåŸŸ (å·¦ä¾§å¤§å›¾)
    ax_main = plt.subplot2grid((3, 5), (0, 0), colspan=3, rowspan=3, facecolor='#0a0a0a')

    # ç›‘æ§é¢æ¿ (å³ä¾§)
    ax_energy = plt.subplot2grid((3, 5), (0, 3), colspan=2, facecolor='#0a0a0a')
    ax_distances = plt.subplot2grid((3, 5), (1, 3), colspan=2, facecolor='#0a0a0a')
    ax_info = plt.subplot2grid((3, 5), (2, 3), colspan=2, facecolor='#0a0a0a')

    # åœ¨åº•éƒ¨ä¸ºæŒ‰é’®ç•™å‡ºç©ºé—´
    plt.subplots_adjust(bottom=0.15)

    # åˆ›å»ºé€Ÿåº¦æ§åˆ¶æŒ‰é’®
    button_height = 0.04
    button_width = 0.08
    button_y = 0.02

    # å‡é€ŸæŒ‰é’®
    ax_slow = plt.axes([0.25, button_y, button_width, button_height])
    btn_slow = Button(ax_slow, 'å‡é€Ÿ', color='#FF4444', hovercolor='#FF6666')
    btn_slow.label.set_color('white')
    btn_slow.label.set_fontweight('bold')

    # é‡ç½®æŒ‰é’®
    ax_reset = plt.axes([0.35, button_y, button_width, button_height])
    btn_reset = Button(ax_reset, 'æ­£å¸¸', color='#4CAF50', hovercolor='#6BCF7F')
    btn_reset.label.set_color('white')
    btn_reset.label.set_fontweight('bold')

    # åŠ é€ŸæŒ‰é’®
    ax_fast = plt.axes([0.45, button_y, button_width, button_height])
    btn_fast = Button(ax_fast, 'åŠ é€Ÿ', color='#2196F3', hovercolor='#42A5F5')
    btn_fast.label.set_color('white')
    btn_fast.label.set_fontweight('bold')

    # æš‚åœ/ç»§ç»­æŒ‰é’®
    ax_pause = plt.axes([0.55, button_y, button_width, button_height])
    btn_pause = Button(ax_pause, 'æš‚åœ', color='#FF9800', hovercolor='#FFB74D')
    btn_pause.label.set_color('white')
    btn_pause.label.set_fontweight('bold')

    # é€Ÿåº¦æ˜¾ç¤ºæ–‡æœ¬
    speed_text = fig.text(0.65, button_y + button_height / 2,
                          speed_controller.get_current_speed_text(),
                          fontsize=12, color='white', va='center', weight='bold')

    # è®¾ç½®ä¸»ç”»å¸ƒ
    ax_main.set_xlim(-8, 8)
    ax_main.set_ylim(-8, 8)
    ax_main.set_aspect('equal')
    ax_main.set_facecolor('#0a0a0a')
    ax_main.tick_params(colors='white')
    ax_main.set_xlabel('X åæ ‡', color='white', fontsize=14)
    ax_main.set_ylabel('Y åæ ‡', color='white', fontsize=14)
    ax_main.set_title('ä¸‰ä½“é—®é¢˜ï¼šä¸‰é¢—æ’æ˜Ÿçš„æ··æ²Œèˆè¹ˆ', color='white', fontsize=16, pad=20)

    # åˆ›å»ºæ˜Ÿç©ºèƒŒæ™¯
    np.random.seed(123)
    star_x = np.random.uniform(-8, 8, 200)
    star_y = np.random.uniform(-8, 8, 200)
    star_sizes = np.random.uniform(0.5, 3, 200)
    ax_main.scatter(star_x, star_y, c='white', s=star_sizes, alpha=0.4)

    # æ·»åŠ ç½‘æ ¼
    ax_main.grid(True, alpha=0.15, color='gray', linestyle='-', linewidth=0.5)

    # åˆå§‹åŒ–ç»˜å›¾å…ƒç´ 
    # 1. ä¸‰ä¸ªæ’æ˜Ÿå¤©ä½“
    stars = []
    for i in range(3):
        star = ax_main.scatter([], [], s=system.base_sizes[i],
                               c=system.colors[i], edgecolors='white',
                               linewidth=3, alpha=0.95, zorder=20)
        stars.append(star)

    # 2. ä¸‰æ¡è½¨è¿¹çº¿
    orbit_trails = []
    for i in range(3):
        trail, = ax_main.plot([], [], color=system.colors[i],
                              linewidth=2.5, alpha=0.8, zorder=10)
        orbit_trails.append(trail)

    # 3. å¼•åŠ›è¿æ¥çº¿
    gravity_lines = []
    gravity_colors = ['yellow', 'orange', 'red']
    line_pairs = [(0, 1), (0, 2), (1, 2)]

    for i, (a, b) in enumerate(line_pairs):
        line, = ax_main.plot([], [], color=gravity_colors[i],
                             alpha=0.4, linewidth=2, linestyle='--', zorder=5)
        gravity_lines.append(line)

    # 4. æ’æ˜Ÿæ ‡ç­¾
    star_labels = []
    for i in range(3):
        label = ax_main.text(0, 0, system.names[i], fontsize=12, color='white',
                             ha='center', va='center', weight='bold',
                             bbox=dict(boxstyle="round,pad=0.3", facecolor=system.colors[i], alpha=0.7))
        star_labels.append(label)

    # 5. ä¿¡æ¯æ˜¾ç¤º
    status_text = ax_main.text(0.02, 0.98, '', transform=ax_main.transAxes,
                               fontsize=12, color='white', verticalalignment='top',
                               bbox=dict(boxstyle="round,pad=0.5",
                                         facecolor="black", alpha=0.8))

    # è®¾ç½®ç›‘æ§å›¾è¡¨
    for ax in [ax_energy, ax_distances]:
        ax.set_facecolor('#0a0a0a')
        ax.tick_params(colors='white')
        ax.grid(True, alpha=0.3, color='gray')

    # èƒ½é‡å›¾
    ax_energy.set_title('ç³»ç»Ÿæ€»èƒ½é‡å®ˆæ’', color='white', fontsize=12)
    ax_energy.set_ylabel('æ€»èƒ½é‡', color='white')
    energy_line, = ax_energy.plot([], [], color='cyan', linewidth=2)

    # è·ç¦»å›¾
    ax_distances.set_title('æ’æ˜Ÿé—´è·ç¦»å˜åŒ–', color='white', fontsize=12)
    ax_distances.set_ylabel('è·ç¦»', color='white')
    ax_distances.set_xlabel('æ—¶é—´æ­¥', color='white')

    dist_lines = {}
    dist_colors = ['red', 'blue', 'green']
    dist_labels = ['Alpha-Beta', 'Alpha-Gamma', 'Beta-Gamma']

    for i, key in enumerate(['AB', 'AC', 'BC']):
        line, = ax_distances.plot([], [], color=dist_colors[i],
                                  linewidth=2, label=dist_labels[i])
        dist_lines[key] = line
    ax_distances.legend(fontsize=10)

    # ä¿¡æ¯é¢æ¿
    ax_info.set_facecolor('#0a0a0a')
    ax_info.axis('off')
    info_display = ax_info.text(0.05, 0.95, '', transform=ax_info.transAxes,
                                fontsize=11, color='white', verticalalignment='top')

    # åŠ¨ç”»çŠ¶æ€æ§åˆ¶
    animation_paused = [False]  # ä½¿ç”¨åˆ—è¡¨ä»¥ä¾¿åœ¨é—­åŒ…ä¸­ä¿®æ”¹

    def toggle_pause(event):
        """åˆ‡æ¢æš‚åœ/ç»§ç»­"""
        animation_paused[0] = not animation_paused[0]
        btn_pause.label.set_text('ç»§ç»­' if animation_paused[0] else 'æš‚åœ')

    def update_speed_display():
        """æ›´æ–°é€Ÿåº¦æ˜¾ç¤º"""
        speed_text.set_text(speed_controller.get_current_speed_text())
        fig.canvas.draw_idle()

    def on_speed_up(event):
        speed_controller.speed_up()
        update_speed_display()

    def on_slow_down(event):
        speed_controller.slow_down()
        update_speed_display()

    def on_reset_speed(event):
        speed_controller.reset_speed()
        update_speed_display()

    # è¿æ¥æŒ‰é’®äº‹ä»¶
    btn_fast.on_clicked(on_speed_up)
    btn_slow.on_clicked(on_slow_down)
    btn_reset.on_clicked(on_reset_speed)
    btn_pause.on_clicked(toggle_pause)

    def animate_frame(frame):
        # å¦‚æœæš‚åœåˆ™ä¸æ›´æ–°
        if animation_paused[0]:
            return (stars + orbit_trails + gravity_lines + star_labels +
                    [status_text, energy_line] + list(dist_lines.values()) + [info_display])

        # æ‰§è¡Œç‰©ç†è®¡ç®— - æ¯å¸§å¤šæ­¥æé«˜ç²¾åº¦
        steps_per_frame = max(1, int(3 / max(0.1, system.speed_multiplier)))
        for _ in range(steps_per_frame):
            system.runge_kutta_4th_order()
            system.update_statistics()

        # æ›´æ–°ä¸‰ä¸ªæ’æ˜Ÿçš„ä½ç½®
        for i in range(3):
            # æ›´æ–°æ’æ˜Ÿä½ç½®
            current_pos = system.positions[i].reshape(1, -1)
            stars[i].set_offsets(current_pos)

            # æ·»åŠ è„‰åŠ¨æ•ˆæœ
            pulse = 1 + 0.2 * np.sin(system.time * 4 + i * 2)
            stars[i].set_sizes([system.base_sizes[i] * pulse])

            # æ›´æ–°æ ‡ç­¾ä½ç½®
            star_labels[i].set_position((system.positions[i][0] + 0.5,
                                         system.positions[i][1] + 0.5))

        # æ›´æ–°è½¨è¿¹
        for i in range(3):
            if len(system.trails[i]) > 1:
                trail_array = np.array(list(system.trails[i]))
                orbit_trails[i].set_data(trail_array[:, 0], trail_array[:, 1])

        # æ›´æ–°å¼•åŠ›è¿æ¥çº¿
        for i, (a, b) in enumerate(line_pairs):
            pos_a = system.positions[a]
            pos_b = system.positions[b]
            gravity_lines[i].set_data([pos_a[0], pos_b[0]], [pos_a[1], pos_b[1]])

            # æ ¹æ®è·ç¦»è°ƒæ•´çº¿æ¡ç²—ç»†å’Œé€æ˜åº¦
            distance = np.linalg.norm(pos_a - pos_b)
            alpha = max(0.2, min(0.8, 5.0 / distance))
            linewidth = max(1, min(4, 8.0 / distance))
            gravity_lines[i].set_alpha(alpha)
            gravity_lines[i].set_linewidth(linewidth)

        # æ›´æ–°çŠ¶æ€ä¿¡æ¯
        current_energy = system.calculate_total_energy()
        max_velocity = max([np.linalg.norm(v) for v in system.velocities])

        status_info = (
            f"æ¨¡æ‹Ÿæ—¶é—´: {system.time:.2f}\n"
            f"æ’­æ”¾é€Ÿåº¦: {system.speed_multiplier:.1f}x\n"
            f"ç³»ç»Ÿæ€»èƒ½é‡: {current_energy:.4f}\n"
            f"æœ€å¤§é€Ÿåº¦: {max_velocity:.3f}\n"
            f"è®¡ç®—æ­¥æ•°: {frame * steps_per_frame}\n"
            f"\nä¸‰ä½“ä½ç½®åæ ‡:\n"
        )

        for i in range(3):
            pos = system.positions[i]
            vel_mag = np.linalg.norm(system.velocities[i])
            status_info += f"{system.names[i]}: ({pos[0]:.2f}, {pos[1]:.2f})\n"
            status_info += f"   é€Ÿåº¦: {vel_mag:.3f}\n"

        status_text.set_text(status_info)

        # æ›´æ–°èƒ½é‡å›¾
        if len(system.energy_history) > 1:
            time_points = list(range(len(system.energy_history)))
            energy_line.set_data(time_points, list(system.energy_history))
            ax_energy.relim()
            ax_energy.autoscale_view()

        # æ›´æ–°è·ç¦»å›¾
        if len(system.distance_history['AB']) > 1:
            time_points = list(range(len(system.distance_history['AB'])))
            for key in ['AB', 'AC', 'BC']:
                dist_lines[key].set_data(time_points, list(system.distance_history[key]))
            ax_distances.relim()
            ax_distances.autoscale_view()

        # æ›´æ–°ä¿¡æ¯é¢æ¿
        min_dist = min([list(system.distance_history[key])[-1]
                        for key in system.distance_history.keys()
                        if len(system.distance_history[key]) > 0])

        info_text = (
            "=== ä¸‰ä½“ç³»ç»ŸçŠ¶æ€ ===\n\n"
            f"æ’æ˜Ÿè´¨é‡:\n"
            f"  {system.names[0]}: {system.masses[0]:.1f}Mâ˜‰\n"
            f"  {system.names[1]}: {system.masses[1]:.1f}Mâ˜‰\n"
            f"  {system.names[2]}: {system.masses[2]:.1f}Mâ˜‰\n\n"
            f"æœ€è¿‘è·ç¦»: {min_dist:.3f}\n"
            f"å¼•åŠ›å¸¸æ•°: {system.G:.1f}\n\n"
            "è§‚å¯Ÿè¦ç‚¹:\n"
            "*  è½¨é“çš„ä¸è§„åˆ™æ€§\n"
            "*  è¿‘è·ç¦»é­é‡äº‹ä»¶\n"
            "*  èƒ½é‡å®ˆæ’å®šå¾‹\n"
            "*  æ··æ²Œæ•æ„Ÿä¾èµ–æ€§\n\n"
            "æ§åˆ¶è¯´æ˜:\n"
            "*  åŠ é€Ÿ/å‡é€ŸæŒ‰é’®è°ƒèŠ‚æ’­æ”¾é€Ÿåº¦\n"
            "*  æš‚åœæŒ‰é’®åœæ­¢/ç»§ç»­åŠ¨ç”»\n"
            "*  æ­£å¸¸æŒ‰é’®é‡ç½®ä¸º1xé€Ÿåº¦"
        )

        info_display.set_text(info_text)

        return (stars + orbit_trails + gravity_lines + star_labels +
                [status_text, energy_line] + list(dist_lines.values()) + [info_display])

    # åˆ›å»ºåŠ¨ç”»å¯¹è±¡
    anim = FuncAnimation(fig, animate_frame, frames=3000,
                         interval=30, blit=False, repeat=True, cache_frame_data=False)

    # æ€»æ ‡é¢˜
    fig.suptitle('ä¸‰ä½“é—®é¢˜æ•°å€¼æ¨¡æ‹Ÿï¼šæ··æ²Œå¼•åŠ›ç³»ç»Ÿï¼ˆé€Ÿåº¦å¯æ§ï¼‰',
                 fontsize=18, color='white', y=0.96)

    # åº•éƒ¨è¯´æ˜
    fig.text(0.02, 0.085,
             'ç‰©ç†åŸç†: ä¸‰ä¸ªè´¨é‡ä¸ç­‰çš„æ’æ˜Ÿåœ¨ä¸‡æœ‰å¼•åŠ›ä½œç”¨ä¸‹çš„éå‘¨æœŸè¿åŠ¨ | '
             'æ··æ²Œç‰¹å¾: è½¨é“ä¸å¯é¢„æµ‹ã€å¯¹åˆå§‹æ¡ä»¶æ•æ„Ÿã€é•¿æœŸè¡Œä¸ºæ— æ³•ç¡®å®š | '
             'æ•°å€¼æ–¹æ³•: å››é˜¶é¾™æ ¼-åº“å¡”æ³•æ±‚è§£ç‰›é¡¿å¼•åŠ›æ–¹ç¨‹ç»„',
             fontsize=10, color='white',
             bbox=dict(boxstyle="round,pad=0.5", facecolor="#1a1a2e", alpha=0.9))

    plt.tight_layout()
    plt.subplots_adjust(top=0.92, bottom=0.18)
    plt.show()

    return anim


# å¯åŠ¨ä¸‰ä½“åŠ¨ç”»
print("ğŸŒŸ å¯åŠ¨ä¸‰ä½“æ’æ˜Ÿç³»ç»ŸåŠ¨æ€æ¨¡æ‹Ÿï¼ˆå¸¦é€Ÿåº¦æ§åˆ¶ï¼‰...")
print("\nç³»ç»Ÿé…ç½®:")
print("*  ä¸‰é¢—è´¨é‡ä¸ç­‰çš„æ’æ˜Ÿ: Alpha(1.5Mâ˜‰), Beta(1.0Mâ˜‰), Gamma(1.2Mâ˜‰)")
print("*  åˆå§‹ä¸‰è§’å½¢é…ç½®ï¼Œèµ‹äºˆå¤æ‚åˆå§‹é€Ÿåº¦")
print("*  é«˜ç²¾åº¦æ•°å€¼ç§¯åˆ†(RK4)ç¡®ä¿é•¿æœŸç¨³å®šæ€§")

print("\nå¯è§†åŒ–ç‰¹å¾:")
print("âœ“ ä¸‰ä¸ªä¸åŒé¢œè‰²çš„æ’æ˜Ÿå®æ—¶è¿åŠ¨")
print("âœ“ å½©è‰²è½¨è¿¹æ˜¾ç¤ºå†å²è·¯å¾„")
print("âœ“ è™šçº¿æ˜¾ç¤ºå¼•åŠ›ç›¸äº’ä½œç”¨")
print("âœ“ æ’æ˜Ÿå¤§å°è„‰åŠ¨æ¨¡æ‹ŸçœŸå®æ•ˆæœ")
print("âœ“ å®æ—¶ç›‘æ§èƒ½é‡å®ˆæ’å’Œè·ç¦»å˜åŒ–")

print("\næ–°å¢é€Ÿåº¦æ§åˆ¶åŠŸèƒ½:")
print("ğŸ® å‡é€ŸæŒ‰é’®: é™ä½æ’­æ”¾é€Ÿåº¦(0.1x-8x)")
print("ğŸ® åŠ é€ŸæŒ‰é’®: æé«˜æ’­æ”¾é€Ÿåº¦(0.1x-8x)")
print("ğŸ® æ­£å¸¸æŒ‰é’®: é‡ç½®ä¸º1xæ­£å¸¸é€Ÿåº¦")
print("ğŸ® æš‚åœæŒ‰é’®: æš‚åœ/ç»§ç»­åŠ¨ç”»æ’­æ”¾")
print("ğŸ® å®æ—¶é€Ÿåº¦æ˜¾ç¤º: å½“å‰æ’­æ”¾å€æ•°")

print("\nè§‚å¯Ÿé‡ç‚¹:")
print("ğŸ” è½¨é“çš„å¤æ‚æ€§å’Œä¸å¯é¢„æµ‹æ€§")
print("ğŸ” æ’æ˜Ÿé—´è·ç¦»çš„å‰§çƒˆå˜åŒ–")
print("ğŸ” è¿‘è·ç¦»é­é‡å¼•èµ·çš„è½¨é“çªå˜")
print("ğŸ” ç³»ç»Ÿæ€»èƒ½é‡çš„ç²¾ç¡®å®ˆæ’")

print("\næ“ä½œæç¤º:")
print("ğŸ’¡ ä½¿ç”¨åŠ é€ŸåŠŸèƒ½å¿«é€Ÿè§‚å¯Ÿé•¿æœŸè¡Œä¸º")
print("ğŸ’¡ ä½¿ç”¨å‡é€ŸåŠŸèƒ½ä»”ç»†ç ”ç©¶ç»†èŠ‚å˜åŒ–")
print("ğŸ’¡ æš‚åœåŠŸèƒ½æ–¹ä¾¿æˆªå›¾å’Œè§‚å¯Ÿ")

print("\næ­£åœ¨åŠ è½½åŠ¨ç”»...")

# è¿è¡ŒåŠ¨ç”»
animation = create_three_body_animation()

print("ğŸ¬ ä¸‰ä½“åŠ¨ç”»å·²å¯åŠ¨ï¼ä½¿ç”¨åº•éƒ¨æŒ‰é’®æ§åˆ¶æ’­æ”¾é€Ÿåº¦...")
```


<div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;">
    <iframe src="//player.bilibili.com/player.html?isOutside=true&aid=114649370462296&bvid=BV1qaTdzWEcD&cid=30395404225&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
</div>


___

## å‚è€ƒ

- [ä¸‰ä½“é—®é¢˜ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¯´ç§‘å­¦çš„å°½å¤´æ˜¯ç¥å­¦ï¼Ÿ](https://www.bilibili.com/video/BV1Fj421Z7MF/?spm_id_from=333.337.search-card.all.click&vd_source=3f2411263f367ccf993c28b58688c0e7)

